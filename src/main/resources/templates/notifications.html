<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <link rel = "stylesheet" href="https://cdn.jsdelivr.net/npm/bootswatch@4.5.2/dist/flatly/bootstrap.min.css" integrity="sha384-qF/QmIAj5ZaYFAeQcrQ6bfVMAh4zZlrGwTPY7T/M+iTTLJqJBJjwwnsE5Y0mV7QK" crossorigin="anonymous" />
    <link rel="stylesheet" th:href="@{/css/styles_profile_page.css}">
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-primary">
    <div class="container-fluid">
        <a class="navbar-brand" th:href="@{/home_page/{id}(id = ${userId})}">TinderZoo</a>
        <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
            <span class="navbar-toggler-icon"></span>
        </button>
        <div class="collapse navbar-collapse" id="navbarColor01">
            <ul class="navbar-nav ml-auto">
                <li class="nav-item">
                    <a class="nav-link active" th:href="@{/home_page/{id}(id = ${userId})}">Home</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link active" th:href="@{/settings/{id}(id = ${userId})}">Settings</a>
                </li>
                <li class="nav-item">
                    <a class="nav-link" th:href="@{/logout}">Logout</a>
                </li>
            </ul>
        </div>
    </div>
</nav>

<div class="container_left" >
    <div class="circular--portrait1" style="display: block; margin-left: auto; margin-right: auto;">
        <img id="profilePict" th:src="'data:image/${profilePicture.imageType};base64,'+${profilePicture.image}"  />
        <script th:inline="javascript">
        /*<![CDATA[*/
            const pictureElem=document.querySelector("#profilePict");
            let profilePicture = /*[[${profilePicture}]]*/ 'default';
            console.log(profilePicture);

            if(profilePicture.image==null){
                pictureElem.src="../images/empty_picture.jpg";
            }

        /*]]>*/
        </script>
    </div>
    <h1 style="text-align: center; display: block; margin-left: auto; margin-right: auto; margin-top: 10px;"><span style=" " th:text="${username}"></span></h1>
</div>




<div class=" text-center display-1" style="margin-left: 25%; margin-right: 50px;">TinderZoo</div>
<div class="rectangle rct_notification col-md-8" >
    <div class="rectangle_title text-center display-4" >Notifications</div>
    <div style="height: 10px;"></div>

    <!-- notification -->
    <div th:each="i : ${index}">
        <div  style="height: 200px; margin-bottom: 20px;" th:id="'div'+${i}">
            <div class="row">
                <div class="circular--portrait1_notification col-md-2" style=" margin-top: 5px; margin-left: 20px;">
                <img th:id="'profilePict'+${i}" th:src="'data:image/'+${profilePictures[i].imageType}+';base64,'+${profilePictures[i].image}"  /> <!-- verifica dupa daca exista poza de profil -->
                </div>
                <div th:id="'match_message'+${i}" class="good_notification col-md-5"><span th:text="'You and '+${names[i]}+' are now matches! Lovely!'"></span> <svg id="color" enable-background="new 0 0 24 24" height="32" viewBox="0 0 24 24" width="32" xmlns="http://www.w3.org/2000/svg"><path d="m11.466 22.776c.141.144.333.224.534.224s.393-.08.534-.224l9.594-9.721c4.001-4.053 1.158-11.055-4.532-11.055-3.417 0-4.985 2.511-5.596 2.98-.614-.471-2.172-2.98-5.596-2.98-5.672 0-8.55 6.984-4.531 11.055z" fill="#f44336"/></svg></div>
                <div th:id="'interest_message'+${i}" class="good_notification col-md-5"><span th:text="'Hey! '+${names[i]}+' is interested in you!'"></span> <svg id="color" enable-background="new 0 0 24 24" height="32" viewBox="0 0 24 24" width="32" xmlns="http://www.w3.org/2000/svg"><circle cx="12" cy="12" fill="#ffd54f" r="12"/><path d="m21.555.964c-.579 0-1.125.195-1.555.531-.43-.336-.976-.531-1.555-.531-1.348 0-2.445 1.048-2.445 2.336 0 2.007 2.975 4.185 3.57 4.601.13.09.28.135.43.135s.3-.045.43-.135c.595-.417 3.57-2.594 3.57-4.601 0-1.288-1.097-2.336-2.445-2.336z" fill="#e53935"/><path d="m5.555 16.964c-.579 0-1.125.195-1.555.531-.43-.336-.976-.531-1.555-.531-1.348 0-2.445 1.048-2.445 2.336 0 2.007 2.975 4.185 3.57 4.601.13.09.28.135.43.135s.3-.045.43-.135c.595-.417 3.57-2.594 3.57-4.601 0-1.288-1.097-2.336-2.445-2.336z" fill="#e53935"/><g fill="#6d4c41"><path d="m9.25 11.25c-.414 0-.75-.336-.75-.75 0-.551-.448-1-1-1s-1 .449-1 1c0 .414-.336.75-.75.75s-.75-.336-.75-.75c0-1.378 1.121-2.5 2.5-2.5s2.5 1.122 2.5 2.5c0 .414-.336.75-.75.75z"/><path d="m18.25 11.25c-.414 0-.75-.336-.75-.75 0-.551-.448-1-1-1s-1 .449-1 1c0 .414-.336.75-.75.75s-.75-.336-.75-.75c0-1.378 1.121-2.5 2.5-2.5s2.5 1.122 2.5 2.5c0 .414-.336.75-.75.75z"/><path d="m12 18c-2.184 0-4.236-.85-5.78-2.395-.293-.293-.293-.768 0-1.061s.768-.293 1.061 0c1.26 1.262 2.936 1.956 4.719 1.956s3.459-.694 4.72-1.955c.293-.293.768-.293 1.061 0s.293.768 0 1.061c-1.545 1.544-3.597 2.394-5.781 2.394z"/></g></svg></div>
                <div class="d-grid gap-2 d-md-block col-md-4 text-right">
                    <form th:action="@{/view_profile}" method="post">
                        <input type="hidden" name="userId" th:value="${users[i]}">
                        <input type="hidden" name="myId" th:value="${userId}">
                        <button th:id="'btn_view'+${i}" class="btn btn-primary" type="submit" style="border-radius: 15px; font-size: 30px; margin-top: 10%; width: 300px;">View profile</button>
                    </form>
                    <form th:action="@{/deleteNotification}" method="post">
                        <input type="hidden" name="notificationId" th:value="${notifications[i].id}">
                        <input type="hidden" name="userId" th:value="${userId}">
                        <button th:id="'btn_ok'+${i}" class="btn btn-primary" type="submit" style="border-radius: 15px; font-size: 30px; margin-top: 5%; margin-bottom: 10%; width: 300px; ">OK</button>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script th:inline="javascript">
                /*<![CDATA[*/

                let index=/*[[${index}]]*/ 'default';
                let profilePictures = /*[[${profilePictures}]]*/ 'default';
                let notifications=/*[[${notifications}]]*/ 'default';
                let len=index.length;

                let img;
                for(let i=0;i<len;i++){
                    img=document.getElementById(`#profilePict${i}`);
                    if(profilePictures[i].image==null){
                        img.src="../images/empty_picture.jpg";
                    }

                    if(notifications[i].type=="match"){
                        document.getElementById(`interest_message${i}`).classList.add("hidden");
                        document.getElementById(`div${i}`).classList.add("rectangle_notification2");
                    }
                    else{
                        document.getElementById(`match_message${i}`).classList.add("hidden");
                        document.getElementById(`div${i}`).classList.add("rectangle_notification1");
                    }
                }

                /*]]>*/
    </script>

</div>
<div style="height: 100px;"></div>

<script th:inline="javascript">
        /*<![CDATA[*/


        /*]]>*/
</script>

</body>
</html>